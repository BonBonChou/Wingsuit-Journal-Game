<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç¿¼è£é£›è¡Œè¨“ç·´æ—¥èªŒ</title>
    <style>
      body {
        font-family: "Noto Sans TC", sans-serif;
        background: linear-gradient(to right, #e8e7cf, #edebaf, #edebab);
        color: #000000;
        text-align: center;
        padding: 2em;
      }
      .container {
        max-width: 700px;
        margin: auto;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 15px;
        padding: 2em;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      }
      h1 {
        font-size: 35px; /* å­—é«”å¤§å° */
        color: #ffffff; /* ç™½è‰²å­—é«”æ¯”è¼ƒé©åˆåšå…‰æšˆæ•ˆæœ */
        font-weight: bold; /* ç²—é«” */
        text-align: center; /* ç½®ä¸­ */
        margin-bottom: 30px; /* ä¸‹æ–¹ç•™ç©º */
        text-shadow:
          0 0 5px #c2a200,
          /* æ·ºç´«å…‰æšˆ */ 0 0 10px #c2a200,
          0 0 15px #c2a200,
          0 0 20px #c2a200;
        /*background-color: #000000;   /* å»ºè­°åŠ æ·±èƒŒæ™¯è®“å…‰æšˆæ›´æ˜é¡¯ */
        padding: 0px;
        border-radius: 10px;
      }
      h4 {
        font-size: 1.4em;
        line-height: 1.6;

        margin-bottom: 1em;
        color: #e3ce0e;
      }
      h5 {
        font-size: 1.2em;
        line-height: 1.2;
        margin-top: 0em;
        margin-bottom: 1em;
        color: #b3a102;
      }
      .intro {
        text-align: left;
        margin-bottom: 0em;

        background: rgba(0, 0, 0, 0.05);
        padding: 0.5em;
        border-radius: 10px;
      }
      .hidden {
        display: none;
      }
      .center {
        text-align: center;
      }
      button {
        margin: 1em;
        padding: 0.75em 2em;
        font-size: 1.2em;
        border-radius: 12px;
        border: none;
        cursor: pointer;
        background: #fcd303;
        color: black;
        transition: background 0.3s ease;
      }
      button:hover { background: #e6cc0a; }
      .choice-btn {
        display: block;
        margin: 1em auto;
        width: 90%;
      } cursor: pointer;
      #question-title {
        font-size: 2em; /* ä½ å¯ä»¥ä¾éœ€æ±‚èª¿æ•´æ•¸å€¼ */
        font-weight: bold; /* ä¹Ÿå¯ä»¥è¨­ç‚º normal, lighter ç­‰ */
        margin-bottom: 0.5em;
        color: #e3ce0e;
      }
      #question-text {
        font-size: 1.5em;
        line-height: 1.6;
        margin-bottom: 1em;
      }
      #knowledge-title {
        font-size: 2em; /* ä½ å¯ä»¥ä¾éœ€æ±‚èª¿æ•´æ•¸å€¼ */
        font-weight: bold; /* ä¹Ÿå¯ä»¥è¨­ç‚º normal, lighter ç­‰ */
        margin-bottom: 0.5em;
        color: #9a42ff;
      }
      #knowledge-text {
        font-size: 1.5em;
        line-height: 1.6;
        margin-bottom: 1em;
        text-align: justify;
      }
      .choice-button {
        display: block;
        margin: 10px auto;
        width: 80%;
      }
      .content {max-width: 600px; margin: auto; }
      .choice-btn {
        display: block;
        width: 100%;
        margin: 0.5em 0;
        padding: 1em;
        font-size: 1em;
      }
      #output {
        margin-top: 2em;
        padding: 1em;
        border: 1px solid #ccc;
        background: #f9f9f9;
        white-space: pre-line;
      }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="container">
      <!-- é¦–é  -->
      <div id="start-screen">
        <h1>ç¿¼è£é£›è¡Œè¨“ç·´æ—¥èªŒ</h1>
        <h4 class="center">è¸ä¸Šå¤©ç©ºä¹‹è·¯ï¼Œæ›¸å¯«å†’éšªç¯‡ç« ï¼</h4>
        <div class="intro">
          <h5>ç«‹é«”åŠ‡å ´é›»å½±ã€Šç¿¼è£é£›è¡Œã€‹çš„å…§å®¹åŒ–ç‚ºé€™æ¬¾å°éŠæˆ²ï¼Œã€‚</h5>
          <h5>ä¸€åŒè¦‹è­‰äººé¡å¦‚ä½•ä¸€æ­¥æ­¥æ¥è¿‘å®‡å®™çš„çœŸç›¸ï¼</h5>
          <h3>ğŸ” éŠæˆ²èªªæ˜</h3>
          <p>
            ğŸŒŒ <strong>èƒŒæ™¯æ•…äº‹</strong
            ><br />ä½ å°‡æ‰®æ¼”ä¸€åç¿¼è£é£›è¡Œå“¡ï¼Œé€éä¸€é€£ä¸²çš„é¸æ“‡é«”é©—é£›è¡Œè¨“ç·´ã€æŒ‘æˆ°æ¥µé™ï¼Œä¸¦æœ€çµ‚å®Œæˆä½ çš„è¨“ç·´æ—¥èªŒã€‚
          </p>
          <p>
            ğŸ§  <strong>ç©æ³•ç°¡ä»‹</strong><br />éŠæˆ²ç¸½å…± 10
            ç¨®æƒ…å¢ƒã€‚æ¯ç¨®æƒ…å¢ƒåªèƒ½é¸æ“‡ä¸€å€‹ç­”æ¡ˆã€‚
          </p>
          <p>
            ğŸ† <strong>ç›®æ¨™èˆ‡çµå±€</strong
            ><br />éŠæˆ²çµæŸå¾Œï¼Œå°‡æ ¹æ“šä½ çš„é¸æ“‡ç²å¾—ä¸åŒçš„ç¿¼è£é£›è¡Œè¨“ç·´æ—¥èªŒã€‚
          </p>
        </div>
        <button onclick="startGame()">é–‹å§‹å‰µå»ºæˆ‘çš„æ—¥èªŒ</button>
      </div>

      <!-- å•é¡Œé é¢ -->
      <div id="question-screen" class="hidden">
        <h2 id="question-title"></h2>
        <p style="text-align: center" id="question-text"></p>
        <div id="question-options"></div>
      </div>
      <!-- çŸ¥è­˜é  -->
      <div class="hidden" id="knowledge-screen">
        <!--<h3 id="knowledge-title">çŸ¥è­˜è£œå……</h3>-->
        <p id="knowledge-text"></p>
        <div id="info-link" class="hidden" style="margin-top: 1em"></div>
        <button onclick="nextQuestion()">ç¹¼çºŒ</button>
      </div>

      <!-- è¼¸å‡ºé é¢ -->
      <div id="output-screen" class="hidden">
        <h2>ğŸŒŸ ä½ çš„è¨“ç·´æ—¥èªŒ</h2>
        <div id="output"></div>
        <button onclick="location.reload()">é‡æ–°é–‹å§‹</button>
        <button onclick="downloadJournal()">ä¸‹è¼‰æ—¥èªŒ</button>
      </div>
    </div>

    <script>
      const state = {
        step: 0,
        answers: {},
        fatal: false,
        journalParts: [],
      }

      const locations = {
        A: "ç‘å£«ï¼šæ„›æ ¼çˆ¾å³°",
        B: "ç¾åœ‹ï¼šæ‘©æŠ¼æ²™æ¼ ",
        C: "æ¾³æ´²ï¼šå¸Œçˆ¾ç£",
      }

      const weatherOptions = [
        { key: "A", label: "æ™´æœ—" },
        { key: "B", label: "æ°£å£“è®ŠåŒ–å¤§" },
        { key: "C", label: "èƒ½è¦‹åº¦ä½ï¼Œæœ‰å¼·é¢¨" },
        { key: "D", label: "èƒ½è¦‹åº¦é›¶" },
      ]

      const questions = [
        {
          key: "location",
          text: "é¸æ“‡ä½ çš„è¨“ç·´åœ°é»ï¼š",
          options: {
            A: locations.A,
            B: locations.B,
            C: locations.C,
          },
          knowledge: {
            A: "æ„›æ ¼çˆ¾å³°æ°£å€™è®ŠåŒ–å¿«é€Ÿï¼Œæ˜¯æ­»äº¡ç‡æ¥µé«˜çš„é£›è¡Œå ´åŸŸã€‚",
            B: "æ‘©æŠ¼æ²™æ¼ é›–åœ°å‹¢è¼ƒä½ï¼Œä½†é«˜æº«èˆ‡å²©å£é£›è¡Œæ¥µå…·æŒ‘æˆ°ã€‚",
            C: "å¸Œçˆ¾ç£é«˜åŸæ°£å€™ä¹¾ç‡¥ï¼Œé©åˆé€²è¡Œé«˜ç©ºè·³å‚˜èˆ‡é€Ÿåº¦æ§åˆ¶è¨“ç·´ã€‚",
          },
        },
        {
          key: "weather",
          question: "ä½ è¦åœ¨é€™ç¨®å¤©æ°£ä¸‹é€²è¡Œé£›è¡Œå—ï¼Ÿ",
          isWeather: true,
        },
        {
          key: "training",
          text: "ä»Šå¤©ä½ è¦å°ˆæ³¨çš„è¨“ç·´ç›®æ¨™æ˜¯ï¼Ÿ",
          options: {
            A: "æå‡å‡åŠ›",
            B: "ç·¨éšŠé£›è¡Œ",
            C: "é«˜ç©ºåŠ é€Ÿèˆ‡æ¸›é€Ÿ",
          },
          knowledge: {
            A: "èª¿æ•´é£›è¡Œå§¿å‹¢èˆ‡å‚¾æ–œè§’åº¦å¯ä»¥æœ€å¤§åŒ–å‡åŠ›ï¼Œæå‡æ»‘ç¿”è·é›¢ã€‚",
            B: "ç·¨éšŠé£›è¡Œéœ€è¦ç·Šå¯†åˆä½œï¼Œä¸¦é¿å…é€²å…¥å¤¥ä¼´ç”¢ç”Ÿçš„æ¹æµå€åŸŸã€‚",
            C: "é«˜ç©ºè·³å‚˜æ™‚é€Ÿåº¦æœƒæ€¥é½ä¸Šå‡ï¼Œå­¸ç¿’æ§åˆ¶å§¿å‹¢å¯æŒæ¡åŠ é€Ÿåº¦èˆ‡çµ‚ç«¯é€Ÿåº¦ã€‚",
          },
        },
        {
          key: "gear",
          text: "ä½ é¸æ“‡çš„é£›é¼ è£è£å‚™æ˜¯ï¼Ÿ",
          options: {
            A: "å‚³çµ±å°¼é¾é£›é¼ è£",
            B: "æ–°å‹æ°£å®¤è£",
            C: "ç¢³çº–ç¶­å¼·åŒ–è£",
          },
          knowledge: {
            A: "æ—©æœŸé£›é¼ è£è¼ƒç‚ºç°¡å–®ï¼Œå°é£›è¡Œè€…çš„å§¿å‹¢æ§åˆ¶è¦æ±‚æ›´é«˜ã€‚",
            B: "æ°£å®¤è£å‚™èƒ½è¿…é€Ÿå……æ°£ç©©å®šæ»‘ç¿”ï¼Œæ˜¯ç›®å‰å¸¸è¦‹çš„ç¿¼è£é¡å‹ã€‚",
            C: "ç¢³çº–ç¶­å¼·åŒ–æè³ªæä¾›æ›´é«˜å‰›æ€§èˆ‡æŠ—é¢¨èƒ½åŠ›ï¼Œæå‡é£›è¡Œç©©å®šæ€§ã€‚",
          },
        },
      ];

      function formatknowledge(knowledge) {
        return knowledge
          .replace(/\n/g, "<br>") // è‹¥ä½  intro è£¡æ˜¯ç”¨æ›è¡Œç¬¦è™Ÿæ–·è¡Œï¼Œä¹Ÿå¯ä»¥åŠ é€™è¡Œ
          .replace(/\s{2,}/g, ""); // æ¸…é™¤å¤šé¤˜ç©ºç™½
      }

      function startGame() {
        document.getElementById("start-screen").classList.add("hidden");
        state.step = 0;
        state.answers = {};
        state.fatal = false;
        state.journalParts = [];
        showQuestion();
      }

      function showQuestion() {
        const step = state.step;
        const q = questions[step];
        const qOptBox = document.getElementById("question-options");
        qOptBox.innerHTML = "";
        document.getElementById("question-screen").classList.remove("hidden");
        document.getElementById("question-title").textContent = q.text;
        document.getElementById("question-text").textContent = q.question;
        if (q.isWeather) {
          const randomWeather =
                weatherOptions[Math.floor(Math.random() * weatherOptions.length)];
          state.currentWeather = randomWeather;

          document.getElementById("question-title").textContent = `ä»Šå¤©çš„å¤©æ°£æ˜¯ï¼š${randomWeather.label}`;

          const yesBtn = document.createElement("button");
          yesBtn.textContent = "æ˜¯çš„ï¼Œé–‹å§‹é£›è¡Œï¼";
          yesBtn.className = "choice-btn";
          yesBtn.onclick = () => {
            state.answers[q.key] = randomWeather.key
            if (randomWeather.key === "D") state.fatal = true
            //state.step++
            nextQuestion()
          };
          qOptBox.appendChild(yesBtn);

          const noBtn = document.createElement("button");
          noBtn.textContent = "æ“‡æ—¥å†æˆ°ï¼Œæ›å€‹å¤©æ°£å§";
          noBtn.className = "choice-btn";
          noBtn.onclick = () => showQuestion();
          qOptBox.appendChild(noBtn);
          return;
        }

        Object.entries(q.options).forEach(([key, label]) => {
          const btn = document.createElement("button");
          btn.textContent = label;
          btn.className = "choice-btn";
          btn.onclick = () => {
            state.answers[q.key] = key;
            renderKnowledgePage(q, key);
          };
          qOptBox.appendChild(btn);
        });
      }

      function renderKnowledgePage(question, selectedKey) {
        document.getElementById("question-screen").classList.add("hidden");
        document.getElementById("knowledge-screen").classList.remove("hidden");

        document.getElementById("knowledge-text").innerHTML = formatknowledge(question.knowledge[selectedKey]);

        const step = state.step;
        const info = questions[step];
        const link = info && info.link;
        const linkArea = document.getElementById("info-link");
        if (link) {
          linkArea.innerHTML = "<p>ç›¸é—œå…§å®¹</p>";

          // æƒ…æ³ 1ï¼šå¤šå€‹ç¶²å€
          if (Array.isArray(link)) {
            link.forEach((l) => {
              linkArea.innerHTML += `<a href="${l.url}" target="_blank" style="display:block; color:#00ccff;">${l.text}</a>`
            });
          }
          // æƒ…æ³ 2ï¼šå–®ä¸€ç¶²å€
          else if (link.url && link.text) {
            linkArea.innerHTML += `<a href="${link.url}" target="_blank" style="display:block; color:#00ccff;">${link.text}</a>`;
          }

          linkArea.classList.remove("hidden");
        } else {
          linkArea.innerHTML = "";
          linkArea.classList.add("hidden");
        }
      }

      function nextQuestion() {
        document.getElementById("knowledge-screen").classList.add("hidden");
        state.step++;
        if (state.step < questions.length) {
          showQuestion();
        } else {
          showOutput();
        }
      }

      function showOutput() {
        document.getElementById("output-screen").classList.remove("hidden");

        const outputEl = document.getElementById("output");
        outputEl.innerText = "";
        const lines = [];

        lines.push("ä»Šå¤©æ˜¯å€‹é‡è¦çš„æ—¥å­ï¼Œæˆ‘é–‹å§‹äº†ç¿¼è£é£›è¡Œçš„è¨“ç·´ä¹‹æ—…ã€‚");

        if (state.answers.location === "A")
          lines.push(
            "æˆ‘ä¾†åˆ°å£¯éº—çš„æ„›æ ¼çˆ¾å³°ï¼Œé€™è£¡æ˜¯ç„¡æ•¸å†’éšªè€…å¤¢æƒ³çš„æŒ‘æˆ°åœ°é»ã€‚æ°£å€™è®ŠåŒ–è¿…é€Ÿï¼Œæ¯ä¸€æ­¥éƒ½å¾—è¬åˆ†å°å¿ƒã€‚",
          );
        if (state.answers.location === "B")
          lines.push(
            "æˆ‘é¸æ“‡åœ¨ç‚™ç†±çš„æ‘©æŠ¼æ²™æ¼ è¨“ç·´ï¼Œé€™è£¡çš„å²©å£èˆ‡é«˜æº«æ§‹æˆæ¥µå…·æŒ‘æˆ°çš„é£›è¡Œç’°å¢ƒã€‚",
          );
        if (state.answers.location === "C")
          lines.push(
            "æˆ‘ä¾†åˆ°æ¾³æ´²å¸Œçˆ¾ç£çš„é«˜åŸï¼Œé€™è£¡æ°£å€™ä¹¾ç‡¥ã€è¦–é‡é–‹é—Šï¼Œæ˜¯é€²è¡Œé«˜ç©ºé£›è¡Œçš„çµ•ä½³å ´æ‰€ã€‚",
          );

        if (state.answers.weather === "D") {
          lines.push(
            "ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘åœ¨èƒ½è¦‹åº¦ç‚ºé›¶çš„æƒ…æ³ä¸‹èµ·é£›ï¼Œæœ€çµ‚è¿·å¤±åœ¨èŒ«èŒ«çš„å¤§é›ªèˆ‡é¢¨æš´ä¹‹ä¸­â€¦â€¦é€™æ¬¡ä»»å‹™ï¼Œä»¥æ²‰é»˜å‘Šçµ‚ã€‚",
          );
        } else {
          const weatherLabel = {
            A: "å¤©æ°£æ™´æœ—ï¼Œæ°£æµç©©å®šï¼Œè®“æˆ‘æ›´å°ˆæ³¨æ–¼æŠ€è¡“çš„æå‡ã€‚",
            B: "æ°£å£“è®ŠåŒ–é »ç¹ï¼Œæˆ‘å¿…é ˆæ™‚åˆ»èª¿æ•´å§¿æ…‹ä¾†æ‡‰å°é¢¨å‹¢ã€‚",
            C: "å¼·é¢¨èˆ‡ä½èƒ½è¦‹åº¦å¢æ·»è¨“ç·´é›£åº¦ï¼Œä¹Ÿç£¨ç·´äº†æˆ‘çš„æ‡‰è®Šèƒ½åŠ›ã€‚",
          };
          lines.push(weatherLabel[state.answers.weather]);

          if (state.answers.training === "A")
            lines.push(
              "æˆ‘å°ˆæ³¨æ–¼æå‡å‡åŠ›çš„è¨“ç·´ï¼Œé€éè§’åº¦èˆ‡å§¿å‹¢çš„èª¿æ•´ä¾†å¢åŠ æ»‘ç¿”è·é›¢ã€‚",
            );
          if (state.answers.training === "B")
            lines.push(
              "æˆ‘é€²è¡Œäº†ç·¨éšŠé£›è¡Œè¨“ç·´ï¼Œèˆ‡å¤¥ä¼´ä¿æŒè‰¯å¥½è·é›¢ï¼Œé¿å…æ¹æµå¹²æ“¾ã€‚",
            );
          if (state.answers.training === "C")
            lines.push("æˆ‘æ¨¡æ“¬äº†é«˜ç©ºåŠ é€Ÿèˆ‡æ¸›é€Ÿçš„å ´æ™¯ï¼Œå­¸ç¿’æ§åˆ¶å§¿æ…‹èˆ‡é€Ÿåº¦è®ŠåŒ–ã€‚");

          if (state.answers.gear === "A")
            lines.push(
              "æˆ‘ä½¿ç”¨çš„æ˜¯å‚³çµ±å°¼é¾é£›é¼ è£ï¼Œå„˜ç®¡ç°¡å–®ï¼Œå»èƒ½å¹«åŠ©æˆ‘å¼·åŒ–åŸºæœ¬é£›è¡ŒæŠ€å·§ã€‚",
            );
          if (state.answers.gear === "B")
            lines.push(
              "æˆ‘ç©¿ä¸Šæ–°å‹æ°£å®¤è£å‚™ï¼Œèƒ½å¿«é€Ÿå……æ°£ç©©å®šæ»‘ç¿”ï¼Œæ˜¯æå‡æ•ˆç‡çš„é‡è¦å·¥å…·ã€‚",
            );
          if (state.answers.gear === "C")
            lines.push(
              "æˆ‘é…å‚™ç¢³çº–ç¶­å¼·åŒ–é£›é¼ è£ï¼Œæä¾›å“è¶Šçš„ç©©å®šæ€§ï¼Œè®“æˆ‘æ›´æœ‰ä¿¡å¿ƒå®Œæˆè¨“ç·´ã€‚",
            );

          lines.push(
            "è¨“ç·´é›–ç„¶è‰±é›£ï¼Œä½†æˆ‘å¾ä¸­å­¸åˆ°äº†å¯¶è²´çš„é£›è¡ŒçŸ¥è­˜èˆ‡ç¶“é©—ã€‚é€™ä¸€åˆ‡éƒ½å°‡æˆç‚ºæˆ‘é€šå¾€é«˜ç©ºå¤¢æƒ³çš„åŸºçŸ³ã€‚",
          );
        }
        // æ‰“å­—æ©Ÿæ•ˆæœ
        let index = 0
        function typeLine() {
          if (index < lines.length) {
            outputEl.innerText += lines[index] + "\n"
            index++
            setTimeout(typeLine, 1000)
          };
        }
        typeLine();
      }

      function downloadJournal() {
        const text = document.getElementById("output").innerText;
        const blob = new Blob([text], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "ç¿¼è£é£›è¡Œè¨“ç·´æ—¥èªŒ.txt";
        a.click();
        URL.revokeObjectURL(url);
      }
    </script>
  </body>
</html>
