<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>翼裝飛行訓練日誌</title>
    <style>
      body {
        font-family: "Noto Sans TC", sans-serif;
        background: linear-gradient(to right, #e8e7cf, #edebaf, #edebab);
        color: #000;
        text-align: center;
        padding: 2em;
      }
      .container {
        max-width: 700px;
        margin: auto;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 15px;
        padding: 2em;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      }
      h1 {
        font-size: 35px; /* 字體大小 */
        color: #ffffff; /* 白色字體比較適合做光暈效果 */
        font-weight: bold; /* 粗體 */
        text-align: center; /* 置中 */
        margin-bottom: 30px; /* 下方留空 */
        text-shadow:
          0 0 5px #c2a200,
          0 0 10px #c2a200,
          0 0 15px #c2a200,
          0 0 20px #c2a200;
        /*background-color: #000000;   /* 建議加深背景讓光暈更明顯 */
        padding: 0px;
        border-radius: 10px;
      }
      h4 {
        font-size: 1.4em;
        line-height: 1.6;
        margin-bottom: 1em;
        color: #e3ce0e;
      }
      h5 {
        font-size: 1.2em;
        line-height: 1.2;
        margin-top: 0em;
        margin-bottom: 1em;
        color: #b3a102;
      }
      .intro {
        text-align: left;
        margin-bottom: 0em;

        background: rgba(0, 0, 0, 0.05);
        padding: 0.5em;
        border-radius: 10px;
      }
      .hidden {
        display: none;
      }
      .center {
        text-align: center;
      }
      button {
        margin: 1em;
        padding: 0.75em 2em;
        font-size: 1.2em;
        border-radius: 12px;
        border: none;
        cursor: pointer;
        background: #fcd303;
        color: black;
        transition: background 0.3s ease;
      }
      button:hover { background: #e6cc0a; }
      .choice-btn {
        display: block;
        margin: 1em auto;
        width: 90%;
        cursor: pointer;
      } 
      #question-title {
        font-size: 2em; /* 你可以依需求調整數值 */
        font-weight: bold; /* 也可以設為 normal, lighter 等 */
        margin-bottom: 0.5em;
        color: #e3ce0e;
      }
      #question-text {
        font-size: 1.5em;
        line-height: 1.6;
        margin-bottom: 1em;
      }
      #knowledge-text {
        font-size: 1.3em;
        line-height: 1.6;
        margin-bottom: 1em;
        text-align: justify;
      }
      .choice-button {
        display: block;
        margin: 10px auto;
        width: 80%;
      }
      .content {max-width: 600px; margin: auto; }
      .choice-btn {
        display: block;
        width: 100%;
        margin: 0.5em 0;
        padding: 1em;
        font-size: 1em;
      }
      #output {
        margin-top: 2em;
        padding: 1em;
        border: 1px solid #ccc;
        background: #f9f9f9;
        white-space: pre-line;
        text-align: justify;
      }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="container">
      <!-- 首頁 -->
      <div id="start-screen">
        <h1>翼裝飛行訓練日誌</h1>
        <h4 class="center">踏上天空之路，書寫冒險篇章！</h4>
        <div class="intro">
          <h5>翼裝飛行是一項結合速度、技巧與風險的極限運動。立體劇場電影《翼裝飛行》的內容化為這款小遊戲，將你的旅程寫入一篇獨一無二的訓練日誌——</h5>
          <h5>見證你的堅持與飛行夢想吧！</h5>
          <h3>🔍 遊戲說明</h3>
          <p>
            🌌 <strong>背景故事</strong><br/>你將踏上和主角羅貝塔相似的飛行旅程，透過一連串的選擇體驗飛行訓練、挑戰極限。在這段訓練旅途中，你將學會判讀天氣、調整飛行姿態、選擇合適裝備等等，並理解背後的物理知識。
          </p>
          <p>
            🧠 <strong>玩法簡介</strong><br />遊戲總共 10 種情境。每種情境只能選擇一個答案。
          </p>
          <p>
            🏆 <strong>目標與結局</strong
            ><br />遊戲結束後，將根據你的選擇獲得專屬的翼裝飛行訓練日誌。
          </p>
        </div>
        <button onclick="startGame()">開始創建我的日誌</button>
      </div>

      <!-- 問題頁面 -->
      <div id="question-screen" class="hidden">
        <h2 id="question-title"></h2>
        <p style="text-align: center" id="question-text"></p>
        <div id="question-options"></div>
      </div>
      <!-- 知識頁 -->
      <div class="hidden" id="knowledge-screen">
        <p id="knowledge-text"></p>
        <div id="info-link" class="hidden" style="margin-top: 1em"></div>
        <button onclick="nextQuestion()">繼續</button>
      </div>
      
      <!-- 結尾頁 -->
      <div id="final-message-screen" class="hidden">
        <h6>冒險家找到了許多前人尚未嘗試的路線，<br>將我們帶到從未有人到過的地方，完成從未有人做過的事情。<br>這就是夢想——尋找終極路線，並在有生之年講述這個故事。</h6>
        <h2 id="final-highlight">未來的科學家，會以你的分析為起點，<br>繼續追尋宇宙的更深層真相。</h2>
        <div id="FMinfo-link" class="hidden" style="margin-top: 1em;"></div>
        <button onclick="showOutput()">下一頁</button>
      </div>

      <!-- 輸出頁面 -->
      <div id="output-screen" class="hidden">
        <h2>🌟 我的訓練日誌</h2>
        <div id="output"></div>
        <button onclick="location.reload()">重新開始</button>
        <button onclick="downloadJournal()">下載日誌</button>
      </div>
    </div>

    <script>
      const state = {
        step: 0,
        answers: {},
        fatal: false,
        journalParts: [],
      }

      const locations = {
        A: "瑞士：愛格爾峰",
        B: "美國：摩押沙漠",
        C: "澳洲：希爾灣上空",
      }

      const weatherOptions = [
        { key: "A", label: "晴朗" },
        { key: "B", label: "氣壓變化大" },
        { key: "C", label: "能見度低，有強風" },
        { key: "D", label: "能見度零" },
      ]

      const questions = [
        {
          key: "location",
          text: "選擇你的訓練地點：",
          options: {
            A: locations.A,
            B: locations.B,
            C: locations.C,
          },
          knowledge: {
            A: "阿爾卑斯山脈的愛格爾峰又稱死亡之牆，天氣變化快速、難以預測，是死亡率極高的飛行場域，超過 60 位冒險家再也沒有回來。",
            B: `摩押沙漠的峭壁雖然只有愛格爾峰的三分之一高，卻是練習低空翼裝飛行(從懸崖而非飛機上縱身躍下)的理想場域。
            
            然而，高溫使空氣密度變低，較難產生足夠的升力，也更容易產生亂流與對流。
            
            這些條件讓飛行更具挑戰性，也考驗飛行員的判斷與姿勢控制能力。`,
            C: `希爾灣的海岸筆直延伸，沙灘平坦寬廣，是天然的飛行著陸跑道。
            
            在這裡從高空躍下，不僅能俯瞰壯麗海景，更能練習高空、長距離與高速滑翔飛行。
            
            相較於山區，這裡的氣流較穩定，是訓練姿勢調整與風阻控制的理想環境。`,
          },
        },
        
        {
          key: "flightplan",
          text: "飛行前，你會怎麼做準備？",
          options: {
            A: "親自走地形，標出備用降落點",
            B: "用地圖與風向圖模擬路線",
            C: "根據經驗反覆模擬應變狀況"
          },
          knowledge: {
            A: `每一次翼裝飛行背後，都是多週的規劃與準備。飛行者需親自踏查地形、確認潛在障礙與安全著陸點。
            
            許多路線需在高海拔地區長時間步行才能完成探查，風向、氣壓與地形交會點都可能是關鍵風險。
            
            預測、模擬、擬定備案，才能讓短短幾分鐘的飛行更加安全、完整。`,
            B: `每一次翼裝飛行背後，都是多週的規劃與準備。飛行者需親自踏查地形、確認潛在障礙與安全著陸點。
            
            許多路線需在高海拔地區長時間步行才能完成探查，風向、氣壓與地形交會點都可能是關鍵風險。
            
            預測、模擬、擬定備案，才能讓短短幾分鐘的飛行更加安全、完整。`,
            C: `每一次翼裝飛行背後，都是多週的規劃與準備。飛行者需親自踏查地形、確認潛在障礙與安全著陸點。
            
            許多路線需在高海拔地區長時間步行才能完成探查，風向、氣壓與地形交會點都可能是關鍵風險。
            
            預測、模擬、擬定備案，才能讓短短幾分鐘的飛行更加安全、完整。`
          }
        },

        {
          key: "weather",
          question: "你要在這種天氣下進行飛行嗎？",
          isWeather: true,
        },
        {
          key: "training",
          text: "今天你要專注的訓練目標是？",
          options: {
            A: "提升升力",
            B: "編隊飛行",
            C: "高空加速與減速",
          },
          knowledge: {
            A: `調整飛行姿勢與傾斜角度可以最大化升力，進而提升滑翔距離。
            
            升力來自空氣在飛翼上下產生的壓力差，與飛行面積和姿勢有關。
            
            良好的姿態可達到約 3:1 的滑翔比，讓你每下降 1 公尺就能滑翔 3 公尺以上。`,
            B: `編隊飛行需要飛行者之間高度的默契與距離控制。每位飛行者在空中飛行時，身後會產生一段不可見、混亂的氣流，稱為尾跡湍流。
            
            若不小心進入這些湍流區域，飛鼠裝可能會摺疊、失速，甚至墜落。安全的飛行位置通常是斜下方或側後方，避免正後方，才能有效避開尾跡。
            
            湍流除了來自前方飛行者，也可能因風與地形交互作用而形成。風速愈強、風向變化愈劇烈，湍流就愈難預測，因此隊形與飛行策略的選擇至關重要。`,
            C: `高空跳傘初期速度迅速上升，在重力加速度作用下，僅 3 秒內時速就可達到 60 英里，8 秒後突破 100 英里。約 15 秒後，由於空氣阻力與重力達成平衡，速度穩定於終端速度。
            
            飛行者可透過調整身體傾斜角與手腳開展程度，控制空氣阻力，達到提速或減速的效果。近年記錄顯示，極端姿勢下的終端速度甚至可突破每小時 250 英里。
            
            當拉開降落傘時，時速將瞬間驟降至 10 英里，如同空中急煞車。這一過程考驗飛行者對時機與姿勢的準確掌握，是飛行訓練中最具風險與技術性的項目之一。`,
          },
        },
        {
          key: "gear",
          text: "你選擇的飛鼠裝裝備是？",
          options: {
            A: "傳統尼龍飛鼠裝",
            B: "碳纖維氣室裝"           
          },
          knowledge: {
            A: `傳統飛鼠裝最早只是將尼龍布料縫在膝蓋與手臂之間，構造簡單、輕巧，主要用於滑翔技巧的初步訓練。
            
            它沒有內建氣室或結構強化，所有升力與穩定性都仰賴飛行者自身的姿勢控制與張力維持。
            
            雖然阻力較大、滑翔距離有限，但能有效幫助飛行者理解升力原理、熟悉空中姿勢，是累積經驗的理想起點。`,
            B: `新型飛鼠裝結合氣室結構與碳纖維內襯，能在跳躍後迅速充氣膨脹，像滑翔翼一樣形成剛性結構。這使飛鼠裝更快產生升力，縮短垂直下墜段，提早進入滑翔狀態。
            進氣口是關鍵設計，它導入氣流讓整件裝備充氣撐開，使裝備穩定如機翼，並提升整體抗風能力。
            氣室裝備與碳纖維的結合讓飛行更穩定、更有效率，也讓飛行者能挑戰過去難以抵達的區域，是現今最主流的翼裝類型。`            
          },
        },
      ];

      function formatknowledge(knowledge) {
        return knowledge
          .replace(/\n/g, "<br>") // 若你 intro 裡是用換行符號斷行，也可以加這行
          .replace(/\s{2,}/g, ""); // 清除多餘空白
      }

      function startGame() {
        document.getElementById("start-screen").classList.add("hidden");
        state.step = 0;
        state.answers = {};
        state.fatal = false;
        state.journalParts = [];
        showQuestion();
      }

      function showQuestion() {
        const step = state.step;
        const q = questions[step];        
        document.getElementById("question-screen").classList.remove("hidden");
        document.getElementById("question-title").textContent = q.text;
        document.getElementById("question-text").textContent = q.question;

        
        const qOptBox = document.getElementById("question-options");
        qOptBox.innerHTML = "";
        if (q.isWeather) {
          const randomWeather =
                weatherOptions[Math.floor(Math.random() * weatherOptions.length)];
          state.currentWeather = randomWeather;

          document.getElementById("question-title").textContent = `今天的天氣是：${randomWeather.label}`;

          const yesBtn = document.createElement("button");
          yesBtn.textContent = "是的，開始飛行！";
          yesBtn.className = "choice-btn";
          yesBtn.onclick = () => {
            state.answers[q.key] = randomWeather.key
            if (randomWeather.key === "D") state.fatal = true
            //state.step++
            nextQuestion()
          };
          qOptBox.appendChild(yesBtn);

          const noBtn = document.createElement("button");
          noBtn.textContent = "擇日再戰，換個天氣吧";
          noBtn.className = "choice-btn";
          noBtn.onclick = () => showQuestion();
          qOptBox.appendChild(noBtn);
          return;
        }

        Object.entries(q.options).forEach(([key, label]) => {
          const btn = document.createElement("button");
          btn.textContent = label;
          btn.className = "choice-btn";
          btn.onclick = () => {
            state.answers[q.key] = key;
            renderKnowledgePage(q, key);
          };
          qOptBox.appendChild(btn);
        });
      }

      function renderKnowledgePage(question, selectedKey) {
        document.getElementById("question-screen").classList.add("hidden");
        document.getElementById("knowledge-screen").classList.remove("hidden");

        document.getElementById("knowledge-text").innerHTML = formatknowledge(question.knowledge[selectedKey]);

        const step = state.step;
        const info = questions[step];
        const link = info && info.link;
        const linkArea = document.getElementById("info-link");
        if (link) {
          linkArea.innerHTML = "<p>相關內容</p>";

          // 情況 1：多個網址
          if (Array.isArray(link)) {
            link.forEach((l) => {
              linkArea.innerHTML += `<a href="${l.url}" target="_blank" style="display:block; color:#00ccff;">${l.text}</a>`
            });
          }
          // 情況 2：單一網址
          else if (link.url && link.text) {
            linkArea.innerHTML += `<a href="${link.url}" target="_blank" style="display:block; color:#00ccff;">${link.text}</a>`;
          }

          linkArea.classList.remove("hidden");
        } else {
          linkArea.innerHTML = "";
          linkArea.classList.add("hidden");
        }
      }

      function nextQuestion() {
        document.getElementById("knowledge-screen").classList.add("hidden");
        state.step++;
        if (state.step < questions.length) {
          showQuestion();
        } else {
          showFM();
        }
      }
      
      function showFM() {
        document.getElementById("final-message-screen").classList.remove("hidden");
        const linkArea = document.getElementById("FMinfo-link");
      	const link = [
          { text: "BBC News：讓人變身成「飛鼠」的翼裝飛行", url: "https://www.bbc.com/ukchina/trad/vert_fut/2016/11/161104_vert_fut_the-man-who-wants-to-jump-out-of-a-plane-in-a-wingsuit"},
          { text: "國家地理雜誌：定點跳傘再傳死亡意外（上）", url: "https://www.natgeomedia.com/environment/article/content-3429.html"},
          { text: "國家地理雜誌：定點跳傘再傳死亡意外（下）", url: "https://www.natgeomedia.com/explore/article/content-3330.html"}
        ]        
        if (link) {
          linkArea.innerHTML = "<p>相關內容</p>";

          if (Array.isArray(link)) {
            link.forEach((l) => {
              linkArea.innerHTML += `<a href="${l.url}" target="_blank" style="display:block; color:#00ccff;">${l.text}</a>`
            });
          }
        }
      }

      function showOutput() {
        document.getElementById("output-screen").classList.remove("hidden");

        const outputEl = document.getElementById("output");
        outputEl.innerText = "";
        const lines = [];

        const introLines = [
          "今天是個重要的日子，我開始了翼裝飛行的訓練之旅。",
          "站在起飛點，我知道這將是改變我的飛行人生的一天。",
          "經過長時間準備，我終於踏上翼裝飛行的訓練征途。"
        ];
        lines.push(randomFrom(introLines));
        
        if (state.answers.flightplan === "A") {
          lines.push(randomFrom([
            "我花了好幾天親自踏查飛行地形，標出每一個可能的備用降落點。",
            "在高海拔的地區反覆行走，讓我更了解地貌與風勢對飛行的潛在影響。",
            "事前走過所有路線，讓我在飛行時更能專注於技巧，而非擔憂未知。"
          ]));
        }
        if (state.answers.flightplan === "B") {
          lines.push(randomFrom([
            "我仔細比對天氣預報、風向圖與地形圖，模擬了多條飛行路線。",
            "結合數據與預測工具，我規劃出一條避開強風與亂流的安全航線。",
            "透過模擬工具，我能預判可能出現的風場變化與障礙物分布。"
          ]));
        }
        if (state.answers.flightplan === "C") {
          lines.push(randomFrom([
            "我根據過往經驗制定多套應變策略，確保每個突發狀況都能應對。",
            "這次的計畫包含了三種備用飛行方案，讓我在空中更從容不迫。",
            "我用腦中模擬飛行多次，每一個轉折點都預先安排了應變選項。"
          ]));
        }


        const locationLines = {
          A: [
            "我來到壯麗的愛格爾峰，這裡被稱為死亡之牆，是無數冒險者夢想的挑戰地點。",
            "我來到壯麗的愛格爾峰，這裡天氣變化極快，訓練時需格外警覺每一個風的訊號。",
            "我來到壯麗的愛格爾峰，這裡有著翼裝飛行最高的風險與榮耀，也有超過 60 位冒險家未能生還。"
          ],
          B: [
            "我選擇了摩押沙漠，在炙熱懸崖間進行懸崖起跳與貼地飛行訓練。",
            "我選擇了摩押沙漠，儘管這裡高度不如阿爾卑斯山，但峭壁地形與熱空氣帶來獨特挑戰。",
            "我選擇了摩押沙漠，這裡的高溫使升力難以掌握，每一次起跳都仰賴極高的判斷力與反應速度。"
          ],
          C: [
            "我來到澳洲的希爾灣，從高空俯瞰筆直海岸與壯麗海景，令人震撼。",
            "我來到澳洲的希爾灣，這裡的氣流穩定，是理想的高空滑翔與風阻控制訓練場。",
            "我來到澳洲的希爾灣，這裡寬廣的沙灘成為完美著陸場，也讓我更安心地練習高速長距離飛行。"
          ]
        };
        lines.push(randomFrom(locationLines[state.answers.location]));


        if (state.answers.weather === "D") {
          const fatalEndings = {
            A: "不幸的是，我在能見度為零的情況下起飛，最終迷失在茫茫的大雪與風暴之中……這次任務，以沉默告終。",
            B: "不幸的是，我在能見度為零的情況下起飛，最終迷失在滾滾黃沙與沙塵暴之中……這次任務，以沉默告終。",
            C: "不幸的是，我在能見度為零的情況下起飛，最終迷失在猛烈暴風雨的席捲之中……這次任務，以沉默告終。"
          };
          lines.push(fatalEndings[state.answers.location]);
        } else {
          const weatherLabel = {
            A: [
              "天氣晴朗，氣流穩定，讓我更專注於技術的提升。",
              "陽光普照，地形清晰可見，是理想的飛行訓練日。",
              "穩定的天氣讓我得以專注於每一個飛行細節的優化。"
            ],
            B: [
              "氣壓變化頻繁，我必須時刻調整姿態來應對風勢。",
              "不穩定的天氣迫使我更靈活地修正飛行軌跡。",
              "今天的氣流複雜，是觀察與實作姿勢控制的好時機。"
            ],
            C: [
              "強風與低能見度增添訓練難度，也磨練了我的應變能力。",
              "在風勢變化劇烈的情況下，我更專注於每一個細節的控制。",
              "惡劣天氣下的飛行是一場意志與技巧的雙重考驗。"
            ]
          };
          lines.push(randomFrom(weatherLabel[state.answers.weather]));

          if (state.answers.training === "A")
            lines.push(
              randomFrom([
                "我專注於提升升力的訓練，透過角度與姿勢的調整來增加滑翔距離。",
                "我反覆練習身體傾斜與展翼姿勢，試圖延長飛行時間。",
                "升力訓練讓我更加理解空氣流動與身體角度之間的微妙關係。"
              ])
            );
          if (state.answers.training === "B")
            lines.push(
              randomFrom([
                "我進行了編隊飛行訓練，與夥伴保持良好距離，避免湍流干擾。",
                "透過觀察夥伴的動作，我學會了即時微調自己的飛行姿態。",
                "編隊飛行不僅需要技術，也需要絕對的專注與默契。"
              ])
            );
          if (state.answers.training === "C")
            lines.push(
              randomFrom([
                "我模擬了高空加速與減速的場景，學習控制姿態與速度變化。",
                "這次的飛行重點是終端速度的掌握與空氣阻力的利用。",
                "透過調整肢體張力與俯仰角，我更熟悉如何在高速中保持穩定。"
              ])
            );

          if (state.answers.gear === "A")
            lines.push(
              randomFrom([
                "我使用的是傳統尼龍飛鼠裝，儘管簡單，卻能幫助我強化基本飛行技巧。",
                "這套裝備要求極高的身體控制力，是磨練基礎的最佳選擇。",
                "尼龍飛鼠裝讓我重新體會風的流動與身體的配合。"
              ])
            );
          if (state.answers.gear === "B")
            lines.push(
              randomFrom([
                "我穿上碳纖維氣室飛鼠裝，起跳後迅速充氣展翼，讓我更早進入穩定滑翔狀態。",
                "這套裝備提供極高剛性與升力，使我在高速飛行中保持穩定，即使遇上亂流也能從容應對。",
                "氣室設計與碳纖維內襯的結合讓飛行更精準、更高效，是挑戰複雜飛行路線的最佳選擇。"
              ])
            );

          lines.push(
            randomFrom([
              "訓練雖然艱難，但我從中學到了寶貴的飛行知識與經驗。這一切都將成為我通往高空夢想的基石。",
              "這段飛行旅程教會我尊重風的力量，也讓我更理解自己在空中的每一個選擇。",
              "每一次飛行都是與自然對話的機會，而今天的訓練，讓我更加堅定了追夢的決心。"
            ])
          );
        }
        // 打字機效果
        let index = 0
        function typeLine() {
          if (index < lines.length) {
            outputEl.innerText += lines[index] + "\n"
            index++
            setTimeout(typeLine, 1000)
          };
        }
        typeLine();
      }
      
      function randomFrom(array) {
        return array[Math.floor(Math.random() * array.length)];
      }

      function downloadJournal() {
        const text = document.getElementById("output").innerText;
        const blob = new Blob([text], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "翼裝飛行訓練日誌.txt";
        a.click();
        URL.revokeObjectURL(url);
      }
    </script>
  </body>
</html>
