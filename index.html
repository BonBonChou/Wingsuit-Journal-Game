<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>我的翼裝飛行訓練日誌</title>
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      background: linear-gradient(to right, #e8e7cf, #edebaf, #edebab);
      color: #000000;
      text-align: center;
      padding: 2em;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: rgba(255,255,255,0.7);
      border-radius: 15px;
      padding: 2em;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    h1 {
      font-size: 35px;             /* 字體大小 */
      color: #ffffff;              /* 白色字體比較適合做光暈效果 */
      font-weight: bold;           /* 粗體 */
      text-align: center;          /* 置中 */
      margin-bottom: 30px;         /* 下方留空 */
      text-shadow: 
        0 0 5px #c2a200,           /* 淺紫光暈 */
        0 0 10px #c2a200,
        0 0 15px #c2a200,
        0 0 20px #c2a200;
      /*background-color: #000000;   /* 建議加深背景讓光暈更明顯 */
      padding: 0px;
      border-radius: 10px;
    }
    h3 {
      font-size: 1.4em;
      line-height: 1.6;

      margin-bottom: 1em;
      color: #c2a200;
    }
    .hidden { display: none; }
    .center { text-align: center; }
    button { padding: 0.5em 1em; margin: 1em 0.5em; font-size: 1em; }
    .choice-btn { display: block; width: 100%; margin: 0.5em 0; padding: 1em; font-size: 1em; }
    #output { margin-top: 2em; padding: 1em; border: 1px solid #ccc; background: #f9f9f9; white-space: pre-line; }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
</head>
<body>
<div class="container">
  <!-- 首頁 -->
  <div id="start-screen">
    <h1>我的翼裝飛行訓練日誌</h1>
    <h3 class="center">踏上天空之路，書寫冒險篇章！</h3>
    <p>這是一款以電影《翼裝飛行》為主題的文字互動遊戲。你將扮演主角羅貝塔，透過一連串的選擇體驗飛行訓練、挑戰極限，並最終完成你的訓練日誌。</p>
    <div class="center">
      <button onclick="nextStep()">開始創建我的日誌</button>
    </div>
  </div>

  <!-- 問題頁面 -->
  <div id="game-screen" class="hidden">
    <div id="question-box"></div>
  </div>

  <!-- 輸出頁面 -->
  <div id="output-screen" class="hidden">
    <h2>你的訓練日誌</h2>
    <div id="output"></div>
    <div class="center">
      <button onclick="restartGame()">重新開始</button>
      <button onclick="downloadJournal()">下載日誌</button>
    </div>
  </div>
</div>

  <script>
    const state = {
      step: 0,
      answers: {},
      fatal: false,
      journalParts: [],
    };

    const locations = {
      A: "瑞士：愛格爾峰",
      B: "美國：摩押沙漠",
      C: "澳洲：希爾灣"
    };

    const weatherOptions = [
      { key: "A", label: "晴朗" },
      { key: "B", label: "氣壓變化大" },
      { key: "C", label: "能見度低，有強風" },
      { key: "D", label: "能見度零" }
    ];

    const questions = [
      {
        key: "location",
        text: "選擇你的訓練地點：",
        options: {
          A: locations.A,
          B: locations.B,
          C: locations.C
        },
        knowledge: {
          A: "愛格爾峰氣候變化快速，是死亡率極高的飛行場域。",
          B: "摩押沙漠雖地勢較低，但高溫與岩壁飛行極具挑戰。",
          C: "希爾灣高原氣候乾燥，適合進行高空跳傘與速度控制訓練。"
        }
      },
      {
        key: "weather",
        isWeather: true
      },
      {
        key: "training",
        text: "今天你要專注的訓練目標是？",
        options: {
          A: "提升升力",
          B: "編隊飛行",
          C: "高空加速與減速"
        },
        knowledge: {
          A: "調整飛行姿勢與傾斜角度可以最大化升力，提升滑翔距離。",
          B: "編隊飛行需要緊密合作，並避免進入夥伴產生的湍流區域。",
          C: "高空跳傘時速度會急遽上升，學習控制姿勢可掌握加速度與終端速度。"
        }
      },
      {
        key: "gear",
        text: "你選擇的飛鼠裝裝備是？",
        options: {
          A: "傳統尼龍飛鼠裝",
          B: "新型氣室裝",
          C: "碳纖維強化裝"
        },
        knowledge: {
          A: "早期飛鼠裝較為簡單，對飛行者的姿勢控制要求更高。",
          B: "氣室裝備能迅速充氣穩定滑翔，是目前常見的翼裝類型。",
          C: "碳纖維強化材質提供更高剛性與抗風能力，提升飛行穩定性。"
        }
      }
    ];

    function nextStep() {
      document.getElementById("start-screen").classList.add("hidden");
      document.getElementById("game-screen").classList.remove("hidden");
      state.step = 0;
      state.answers = {};
      state.fatal = false;
      state.journalParts = [];
      renderQuestion();
    }

    function renderQuestion() {
      const qBox = document.getElementById("question-box");
      qBox.innerHTML = "";

      const step = state.step;
      const question = questions[step];

      if (question.isWeather) {
        const randomWeather = weatherOptions[Math.floor(Math.random() * weatherOptions.length)];
        state.currentWeather = randomWeather;

        const q = document.createElement("div");
        q.innerHTML = `<h3>今天的天氣是：${randomWeather.label}</h3><p>你要在這種天氣下進行飛行嗎？</p>`;
        qBox.appendChild(q);

        const yesBtn = document.createElement("button");
        yesBtn.innerText = "是的，開始飛行！";
        yesBtn.className = "choice-btn";
        yesBtn.onclick = () => {
          state.answers[question.key] = randomWeather.key;
          if (randomWeather.key === "D") state.fatal = true;
          state.step++;
          renderQuestion();
        };
        qBox.appendChild(yesBtn);

        const noBtn = document.createElement("button");
        noBtn.innerText = "擇日再戰，換個天氣吧";
        noBtn.className = "choice-btn";
        noBtn.onclick = () => renderQuestion();
        qBox.appendChild(noBtn);
        return;
      }

      const title = document.createElement("h3");
      title.innerText = question.text;
      qBox.appendChild(title);

      Object.entries(question.options).forEach(([key, label]) => {
        const btn = document.createElement("button");
        btn.innerText = label;
        btn.className = "choice-btn";
        btn.onclick = () => {
          state.answers[question.key] = key;
          renderKnowledgePage(question, key);
        };
        qBox.appendChild(btn);
      });
    }

    function renderKnowledgePage(question, selectedKey) {
      const qBox = document.getElementById("question-box");
      qBox.innerHTML = `<p>${question.knowledge[selectedKey]}</p>`;
      const btn = document.createElement("button");
      btn.innerText = "繼續";
      btn.onclick = () => {
        state.step++;
        if (state.step >= questions.length) {
          showOutput();
        } else {
          renderQuestion();
        }
      };
      qBox.appendChild(btn);
    }

    function showOutput() {
      document.getElementById("game-screen").classList.add("hidden");
      document.getElementById("output-screen").classList.remove("hidden");

      const outputEl = document.getElementById("output");
      outputEl.innerText = "";
      const lines = [];

      // 簡化版日誌內容產生
      lines.push("今天是個重要的日子，我開始了翼裝飛行的訓練之旅。");
      if (state.answers.location === "A") lines.push("我來到壯麗的愛格爾峰，這裡是無數冒險者夢想的挑戰地點。");
      if (state.answers.location === "B") lines.push("我選擇在炙熱的摩押沙漠訓練，挑戰懸崖與高溫。");
      if (state.answers.location === "C") lines.push("我來到澳洲希爾灣的高原，學習如何掌控速度與氣流。");

      if (state.answers.weather === "D") {
        lines.push("不幸的是，我在能見度為零的情況下起飛，最終迷失在茫茫的大雪與風暴之中……");
      } else {
        lines.push("訓練雖然艱難，但我從中學到了寶貴的飛行知識與經驗。");
        lines.push("這一切都將成為我通往高空夢想的基石。");
      }

      // 打字機效果
      let index = 0;
      function typeLine() {
        if (index < lines.length) {
          outputEl.innerText += lines[index] + "\n";
          index++;
          setTimeout(typeLine, 1000);
        }
      }
      typeLine();
    }

    function restartGame() {
      document.getElementById("output-screen").classList.add("hidden");
      document.getElementById("start-screen").classList.remove("hidden");
    }

    function downloadJournal() {
      const text = document.getElementById("output").innerText;
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "翼裝飛行訓練日誌.txt";
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
